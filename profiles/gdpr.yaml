standard: "GDPR"
description: "General Data Protection Regulation (GDPR) - Expanded Technical Controls"
controls:
  # --- Encryption & Pseudonymisation ---
  - id: "GDPR-32.1.a-1"
    name: "Encryption of Personal Data (Storage)"
    description: "Implement measures to encrypt personal data at rest."
    check_tool: "script"
    command: "lsblk -f | grep LUKS"
    remediation: "Encrypt storage devices using LUKS."

  - id: "GDPR-32.1.a-2"
    name: "Encryption of Personal Data (Transit)"
    description: "Implement measures to encrypt personal data in transit."
    check_tool: "script"
    command: "nmap --script ssl-enum-ciphers -p 443 localhost"
    remediation: "Ensure HTTPS/TLS is used."

  # --- Confidentiality & Integrity ---
  - id: "GDPR-32.1.b-1"
    name: "File Permissions (Confidentiality)"
    description: "Ensure sensitive files are not world-readable."
    check_tool: "script"
    command: "find /home -maxdepth 2 -type f -perm /004 -ls"
    remediation: "Restrict file permissions (chmod o-r)."

  - id: "GDPR-32.1.b-2"
    name: "Default Umask"
    description: "Ensure new files are created with restricted permissions."
    check_tool: "script"
    command: "grep 'umask' /etc/profile /etc/bash.bashrc"
    remediation: "Set umask 027 in /etc/profile."

  # --- Availability & Resilience ---
  - id: "GDPR-32.1.b-3"
    name: "Backup Verification"
    description: "Ensure the ability to restore the availability and access to personal data."
    check_tool: "script"
    command: "ls -l /var/backups/"
    remediation: "Implement a regular backup strategy."

  # --- Regular Testing ---
  - id: "GDPR-32.1.d"
    name: "Vulnerability Scanning"
    description: "Regularly test and evaluate effectiveness of technical measures."
    check_tool: "script"
    command: "lynis show version"
    remediation: "Install Lynis for regular auditing."

  # --- Access Control ---
  - id: "GDPR-Access-1"
    name: "Least Privilege - Sudoers"
    description: "Minimize number of users with administrative access."
    check_tool: "script"
    command: "grep '^sudo:' /etc/group"
    remediation: "Review sudo group membership."

  - id: "GDPR-Access-2"
    name: "Root Account Lock"
    description: "Direct root login should be disabled."
    check_tool: "script"
    command: "grep '^PermitRootLogin no' /etc/ssh/sshd_config"
    remediation: "Disable root login in SSH."

  # --- Logging & Monitoring ---
  - id: "GDPR-Logging"
    name: "Access Logs"
    description: "Log access to personal data processing systems."
    check_tool: "script"
    command: "ls -l /var/log/auth.log"
    remediation: "Ensure auth.log is active."
