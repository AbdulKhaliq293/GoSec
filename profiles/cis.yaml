standard: "CIS"
description: "Center for Internet Security (CIS) Benchmark Level 1 - Sample Controls"
controls:
  - id: "CIS-1.1.1"
    name: "Disable CRAM-MD5 in SSH"
    description: "Ensure CRAM-MD5 is disabled in SSH configuration"
    check_tool: "script"
    command: "grep -i 'CRAM-MD5' /etc/ssh/sshd_config"
    remediation: "Remove CRAM-MD5 from /etc/ssh/sshd_config"

  - id: "CIS-5.2.1"
    name: "Ensure SSH Protocol is set to 2"
    description: "SSH Protocol 1 suffers from design flaws that allow the attacker to modify the integrity of the communication channel."
    check_tool: "script"
    command: "grep '^Protocol 2' /etc/ssh/sshd_config || echo 'Not Found'"
    remediation: "Add 'Protocol 2' to /etc/ssh/sshd_config"

  - id: "CIS-5.2.2"
    name: "Ensure SSH LogLevel is INFO"
    description: "INFO LogLevel captures key events for auditing."
    check_tool: "script"
    command: "grep '^LogLevel INFO' /etc/ssh/sshd_config"
    remediation: "Set 'LogLevel INFO' in /etc/ssh/sshd_config"

  - id: "CIS-5.2.3"
    name: "Ensure SSH Root Login is Disabled"
    description: "Permitting root login over SSH increases the risk of brute force attacks."
    check_tool: "script"
    command: "grep '^PermitRootLogin no' /etc/ssh/sshd_config"
    remediation: "Set 'PermitRootLogin no' in /etc/ssh/sshd_config"

  - id: "CIS-1.1.21"
    name: "Sticky Bit on World-Writable Directories"
    description: "Ensure sticky bit is set on all world-writable directories."
    check_tool: "script"
    command: "df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null"
    remediation: "Run: df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null | xargs -I '{}' chmod a+t '{}'"

  - id: "CIS-3.4.1"
    name: "Ensure TCP Wrappers is installed"
    description: "TCP Wrappers provides a simple access control language for network services."
    check_tool: "script"
    command: "dpkg -s tcpd > /dev/null 2>&1 && echo 'Installed' || echo 'Not Installed'"
    remediation: "Run: sudo apt-get install tcpd"
