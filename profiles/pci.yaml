standard: "PCI-DSS"
description: "Payment Card Industry Data Security Standard (PCI DSS) 4.0 - Sample Controls"
controls:
  - id: "PCI-1.2.1"
    name: "Restrict Inbound and Outbound Traffic"
    description: "Build firewall and router configurations that restrict traffic to that which is necessary for the cardholder data environment."
    check_tool: "script"
    command: "sudo iptables -L -n | grep -E 'DROP|REJECT' || echo 'No restrictions found'"
    remediation: "Configure iptables/ufw to deny unnecessary traffic."

  - id: "PCI-2.2.4"
    name: "Remove unnecessary services"
    description: "Ensure that only necessary services are running to reduce the attack surface."
    check_tool: "script"
    command: "systemctl list-units --type=service --state=running"
    remediation: "Disable unused services via systemctl disable <service>"

  - id: "PCI-8.2.3"
    name: "Password Complexity"
    description: "Passwords/passphrases must meet complexity requirements (min len 12, alpha+numeric)."
    check_tool: "script"
    command: "grep -E 'pam_pwquality.so|pam_cracklib.so' /etc/pam.d/common-password"
    remediation: "Configure pam_pwquality in /etc/pam.d/common-password."

  - id: "PCI-10.2.2"
    name: "Audit Log Retention"
    description: "Verify that audit logs are retained for at least one year."
    check_tool: "script"
    command: "grep '^rotate' /etc/logrotate.conf"
    remediation: "Ensure log rotation is set to keep logs for sufficient time (e.g. rotate 52 for weekly)."

  - id: "PCI-6.3.3"
    name: "Software Patches"
    description: "Ensure that system security patches are applied."
    check_tool: "script"
    command: "apt-get -s upgrade | grep '0 upgraded' || echo 'Updates Available'"
    remediation: "Run apt-get update && apt-get upgrade."

  - id: "PCI-4.1.1"
    name: "Strong Cryptography"
    description: "Ensure strong cryptography/protocols for sensitive data transmission."
    check_tool: "nmap"
    command: "nmap --script ssl-enum-ciphers -p 443 localhost"
    remediation: "Disable weak ciphers (SSLv3, TLS 1.0) in web server config."
